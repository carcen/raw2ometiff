[![Build status](https://ci.appveyor.com/api/projects/status/hvqqnbiwmo90m2fd?svg=true)](https://ci.appveyor.com/project/gs-jenkins/raw-to-ome-tiff)

raw-to-ome-tiff converter
=========================

Java application to convert a directory of tiles to an OME-TIFF pyramid.
This is the second half of iSyntax/.mrxs => OME-TIFF conversion.


Usage
=====

Build with Gradle:

    gradle clean build

Unpack the distribution:

    cd build/distributions
    unzip raw-to-ome-tiff-$VERSION.zip
    cd raw-to-ome-tiff-$VERSION

Run the conversion (Bio-Formats 6.x):

    bin/raw-to-ome-tiff tile_directory --output pyramid.ome.tiff

or generate a 5.9.x-compatible pyramid:

    bin/raw-to-ome-tiff tile_directory --output pyramid.tiff --legacy

This same command should work independent of the `--no_pyramid` and `--file_type` options used in the `isyntax-to-raw` step.
If a pyramid was not generated by `isyntax-to-raw`, then this will use the `loci.common.image.IImageScaler` API to create one.

By default, LZW compression will be used in the OME-TIFF file.
The compression can be changed using the `--compression` option.

If working with zarr pyramids, libblosc (https://github.com/Blosc/c-blosc) version 1.9.0 or later must be installed separately.
The native libraries are not packaged with any relevant jars.  See also note in n5-zarr readme (https://github.com/saalfeldlab/n5-zarr/blob/0.0.2-beta/README.md)

Areas to improve
================

* Compress tiles in parallel
* Compatibility with both iSyntax and .mrxs
    - map JSON metadata to OME-XML (magnification etc.)
    - fix tile sizes used when downsampling (TIFF input only)
* Better type detection for zarr/n5
    - right now, the tile directory name must end with ".zarr" or ".n5", and cannot be specified with a trailing file separator
* Fix n5 support (NPEs in this line: https://github.com/saalfeldlab/n5/blob/2.1.2/src/main/java/org/janelia/saalfeldlab/n5/AbstractGsonReader.java#L99)
